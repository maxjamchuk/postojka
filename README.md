# üü• POSTOJKA

![Postojka logo](./logo.png)

**Postojka** ‚Äî —ç—Ç–æ FastAPI-—Å–µ—Ä–≤–∏—Å, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç–µ–∫—Å—Ç –ø–æ—Å—Ç–∞ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–π –±–ª–∏–∑–æ—Å—Ç–∏.
–û–Ω –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –≤ –¥–≤—É—Ö —Ä–µ–∂–∏–º–∞—Ö:

* üìÑ `file` ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–π JSON-—Ñ–∞–π–ª (`data/posts.json`) —Å –ø–æ—Å—Ç–∞–º–∏
* üí¢ `database` ‚Äî –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –∫ PostgreSQL –∏ –ø–æ–ª—É—á–∞—Ç—å –ø–æ—Å—Ç—ã –∏–∑ —Ç–∞–±–ª–∏—Ü—ã

---

## üß∞ –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

| –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è                | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                           |
| ------------------------- | ------------------------------------ |
| **FastAPI**               | API-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ |
| **Uvicorn**               | ASGI-—Å–µ—Ä–≤–µ—Ä –¥–ª—è –∑–∞–ø—É—Å–∫–∞ FastAPI      |
| **sentence-transformers** | –î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –ø–æ—Å—Ç–æ–≤     |
| **Faiss**                 | –ë—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫ –±–ª–∏–∂–∞–π—à–∏—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤     |
| **psycopg2-binary**       | –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL             |
| **pydantic-settings**     | –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ `.env`            |

---

## ü§ñ –ß—Ç–æ —Ç–∞–∫–æ–µ Faiss?

Faiss ‚Äî —ç—Ç–æ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –æ—Ç Facebook –¥–ª—è **–ø–æ–∏—Å–∫–∞ –±–ª–∏–∂–∞–π—à–∏—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤**.
–û–Ω–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –±—ã—Å—Ç—Ä–æ –Ω–∞—Ö–æ–¥–∏—Ç—å –ø–æ—Ö–æ–∂–∏–µ –ø–æ—Å—Ç—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤. –í–º–µ—Å—Ç–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –∫–∞–∂–¥–æ–≥–æ —Å –∫–∞–∂–¥—ã–º (—á—Ç–æ –º–µ–¥–ª–µ–Ω–Ω–æ), Faiss —Å—Ç—Ä–æ–∏—Ç –∏–Ω–¥–µ–∫—Å, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å –±–ª–∏–∂–∞–π—à–∏–µ —Ç–µ–∫—Å—Ç—ã –∑–∞ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥—ã.

---

## üöÄ –ó–∞–ø—É—Å–∫

### 1. –ö–ª–æ–Ω–∏—Ä—É–π –ø—Ä–æ–µ–∫—Ç

```bash
git clone https://github.com/yourusername/postojka.git
cd postojka
````

### 2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –æ–∫—Ä—É–∂–µ–Ω–∏–µ

–°–æ–∑–¥–∞–π `.env` –ø–æ –ø—Ä–∏–º–µ—Ä—É `.env.example`
–ù–∞—Å—Ç—Ä–æ–π `DATA_SOURCE=file` –∏–ª–∏ `DATA_SOURCE=database`

### 3. –°–æ–±–µ—Ä–∏ –∏ –∑–∞–ø—É—Å—Ç–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä

```bash
docker-compose up --build
```

–°–µ—Ä–≤–∏—Å –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞:
‚û° `http://localhost:8002/`

---

## üß™ Swagger-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É:
üìö [`http://localhost:8002/docs`](http://localhost:8002/docs)

### –ß—Ç–æ —Ç–∞–º –º–æ–∂–Ω–æ:

* –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä—É—á–∫—É `/recommend`
* –í–≤–µ—Å—Ç–∏ –ø—Ä–∏–º–µ—Ä —Ç–µ–∫—Å—Ç–∞ (–Ω–∞ —Ä—É—Å—Å–∫–æ–º)
* –ü–æ–ª—É—á–∏—Ç—å ID –∏ –æ—Ü–µ–Ω–∫–∏ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö –ø–æ—Å—Ç–æ–≤

---

## üîå –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ Django

### –ü—Ä–∏–º–µ—Ä–Ω—ã–π –ø—É—Ç—å:

1. –í Django-—Å–æ—Ü—Å–µ—Ç–∏ –¥–æ–±–∞–≤–∏—Ç—å –≤—å—é—à–∫—É `RecommendedPostsView` (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–µ–∑ `ListView`).
2. –ü—Ä–∏ –∑–∞—Ö–æ–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –µ–≥–æ —Ç–µ–∫—Å—Ç/–∏–Ω—Ç–µ—Ä–µ—Å/ID –ª–∞–π–∫–Ω—É—Ç—ã—Ö –ø–æ—Å—Ç–æ–≤ –≤ `http://postojka:8000/recommend` (–∏–ª–∏ `localhost:8002` –≤–Ω–µ Docker).
3. –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ `post_id` –∏ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ –Ω–∏–º `Post.objects.filter(id__in=...)`.
4. –í—ã–≤–µ—Å—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–æ–π –≤–∫–ª–∞–¥–∫–µ ‚Äî "–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã–µ".

–ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Django-–±–∏–±–ª–∏–æ—Ç–µ–∫—É `requests` –∏–ª–∏ `httpx`.

---

## üß± –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞

```http
POST /recommend
Content-Type: application/json

{
  "text": "–ú–Ω–µ –ø–æ–Ω—Ä–∞–≤–∏–ª—Å—è –∞–ª—å–±–æ–º –ó–µ–º—Ñ–∏—Ä—ã",
  "top_k": 3
}
```

–û—Ç–≤–µ—Ç:

```json
{
  "recommended": [
    {"post_id": 4, "score": 0.78},
    {"post_id": 1, "score": 0.65},
    ...
  ]
}
```